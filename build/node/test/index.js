"use strict";

var _amen = require("@dashkite/amen");

var _amenConsole = _interopRequireDefault(require("@dashkite/amen-console"));

var _assert = _interopRequireDefault(require("@dashkite/assert"));

var _configuration = _interopRequireDefault(require("./configuration.js"));

var _base = require("../src/base.js");

var _index = require("../src/index.js");

var _html = _interopRequireDefault(require("./helpers/html.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var test;

test = function (name, f) {
  return (0, _amen.test)({
    description: name,
    wait: 30000
  }, f);
};

(async function ({
  base,
  record
}) {
  (0, _amenConsole.default)(await (0, _amen.test)("Airtable Helpers", [await (0, _amen.test)("Base", [await test("create", async function () {
    base = await _base.Base.create(_configuration.default.airtable);
    return await base.create({
      table: "Test",
      records: [{
        "Name": "Test",
        "Notes": "This is a test."
      }]
    });
  }), await (0, _amen.test)("find", [test("single", async function () {
    record = await base.find({
      table: "Pagination Test",
      id: "recqH6NNMug5nFtC2"
    });
    return (0, _assert.default)(record != null);
  }), test("multiple", async function () {
    record = await base.findAll({
      table: "Pagination Test",
      ids: ["recqH6NNMug5nFtC2", "rec1HIU8rDLhLgW9g"]
    });
    return _assert.default.equal(2, record.length);
  }), test("single not found", async function () {
    record = await base.find({
      table: "Pagination Test",
      id: "foobar"
    });
    return (0, _assert.default)(record == null);
  }), test("multiple not found", async function () {
    record = await base.findAll({
      table: "Pagination Test",
      ids: ["foo", "bar"]
    });
    return _assert.default.equal(0, record.length);
  })]), await test("selectOne", async function () {
    record = await base.selectOne({
      table: "Test",
      query: "{Name} = 'Test'"
    });
    return _assert.default.equal("Test", record.get("Name"));
  }), await test("selectAll", async function () {
    var records;
    records = await base.selectAll({
      table: "Pagination Test"
    });
    return _assert.default.equal(110, records.length);
  }), await test("update", async function () {
    var notes;
    notes = record.get("Notes");

    if (notes === "This is a test.") {
      notes = "This is not a test.";
    } else {
      notes = "This is a test.";
    }

    record = await base.update({
      table: "Test",
      id: record.id,
      fields: {
        Notes: notes
      }
    });
    return _assert.default.equal(notes, record.get("Notes"));
  }), await test("replace", async function () {
    var notes;
    notes = record.get("Notes");

    if (notes === "This is a test.") {
      notes = "This is not a test.";
    } else {
      notes = "This is a test.";
    }

    record = await base.replace({
      table: "Test",
      id: record.id,
      fields: {
        Notes: notes
      }
    });
    return _assert.default.equal(notes, record.get("Notes"));
  }), await test("delete", async function () {
    return await base.delete({
      table: "Test",
      id: record.id
    });
  })])]));
  return process.exit(_amen.success);
})({});
//# sourceMappingURL=data:application/json;base64,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RTtBQUFBLFFBQUEsS0FBQSxFQUFPO0FBQVA7QUFIRixLQURhLENBQWY7V0FNQSxnQkFBQSxLQUFBLENBQUEsS0FBQSxFQUFvQixNQUFNLENBQU4sR0FBQSxDQUFwQixPQUFvQixDQUFwQixDO0FBbEZnQixHQW1FWixDQW5FWSxFQW9GbEIsTUFBTSxJQUFBLENBQUEsUUFBQSxFQUFlLGtCQUFBO0FBQ25CLFdBQUEsTUFBTSxJQUFJLENBQUosTUFBQSxDQUNKO0FBQUEsTUFBQSxLQUFBLEVBQUEsTUFBQTtBQUNBLE1BQUEsRUFBQSxFQUFJLE1BQU0sQ0FBQztBQURYLEtBREksQ0FBTjtBQXJGZ0IsR0FvRlosQ0FwRlksQ0FBZCxDQUY4QixDQUExQixDQUFaO1NBaUdBLE9BQU8sQ0FBUCxJQUFBLENBQUEsYUFBQSxDO0FBbkdDLENBQUEsRUFBb0IsRUFBcEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0ZXN0IGFzIF90ZXN0LCBzdWNjZXNzIH0gZnJvbSBcIkBkYXNoa2l0ZS9hbWVuXCJcbmltcG9ydCBwcmludCBmcm9tIFwiQGRhc2hraXRlL2FtZW4tY29uc29sZVwiXG5pbXBvcnQgYXNzZXJ0IGZyb20gXCJAZGFzaGtpdGUvYXNzZXJ0XCJcblxuaW1wb3J0IGNvbmZpZ3VyYXRpb24gZnJvbSBcIi4vY29uZmlndXJhdGlvblwiXG5cbmltcG9ydCB7IEJhc2UgfSBmcm9tIFwiLi4vc3JjL2Jhc2VcIlxuaW1wb3J0IHsgU2l0ZSwgUGFnZSwgQ29udGVudCB9IGZyb20gXCIuLi9zcmNcIlxuXG5pbXBvcnQgaHRtbCBmcm9tIFwiLi9oZWxwZXJzL2h0bWxcIlxuXG50ZXN0ID0gKG5hbWUsIGYpIC0+XG4gIF90ZXN0XG4gICAgZGVzY3JpcHRpb246IG5hbWVcbiAgICB3YWl0OiAzMDAwMFxuICAgIGZcblxuZG8gKHsgYmFzZSwgcmVjb3JkIH0gPSB7fSkgLT5cblxuICBwcmludCBhd2FpdCBfdGVzdCBcIkFpcnRhYmxlIEhlbHBlcnNcIiwgW1xuXG4gICAgYXdhaXQgX3Rlc3QgXCJCYXNlXCIsIFtcblxuICAgICAgYXdhaXQgdGVzdCBcImNyZWF0ZVwiLCAtPlxuICAgICAgICBiYXNlID0gYXdhaXQgQmFzZS5jcmVhdGUgY29uZmlndXJhdGlvbi5haXJ0YWJsZVxuICAgICAgICBhd2FpdCBiYXNlLmNyZWF0ZVxuICAgICAgICAgIHRhYmxlOiBcIlRlc3RcIlxuICAgICAgICAgIHJlY29yZHM6IFtcbiAgICAgICAgICAgIFwiTmFtZVwiOiBcIlRlc3RcIlxuICAgICAgICAgICAgXCJOb3Rlc1wiOiBcIlRoaXMgaXMgYSB0ZXN0LlwiXG4gICAgICAgICAgXVxuXG4gICAgICBhd2FpdCBfdGVzdCBcImZpbmRcIiwgW1xuICAgICAgICBcbiAgICAgICAgdGVzdCBcInNpbmdsZVwiLCAtPlxuICAgICAgICAgIHJlY29yZCA9IGF3YWl0IGJhc2UuZmluZCBcbiAgICAgICAgICAgIHRhYmxlOiBcIlBhZ2luYXRpb24gVGVzdFwiXG4gICAgICAgICAgICBpZDogXCJyZWNxSDZOTk11ZzVuRnRDMlwiXG4gICAgICAgICAgYXNzZXJ0IHJlY29yZD9cblxuICAgICAgICB0ZXN0IFwibXVsdGlwbGVcIiwgLT5cbiAgICAgICAgICByZWNvcmQgPSBhd2FpdCBiYXNlLmZpbmRBbGxcbiAgICAgICAgICAgIHRhYmxlOiBcIlBhZ2luYXRpb24gVGVzdFwiXG4gICAgICAgICAgICBpZHM6IFsgXCJyZWNxSDZOTk11ZzVuRnRDMlwiLCBcInJlYzFISVU4ckRMaExnVzlnXCIgXVxuICAgICAgICAgIGFzc2VydC5lcXVhbCAyLCByZWNvcmQubGVuZ3RoXG4gICAgICAgICAgXG4gICAgICAgIHRlc3QgXCJzaW5nbGUgbm90IGZvdW5kXCIsIC0+XG4gICAgICAgICAgcmVjb3JkID0gYXdhaXQgYmFzZS5maW5kIFxuICAgICAgICAgICAgdGFibGU6IFwiUGFnaW5hdGlvbiBUZXN0XCJcbiAgICAgICAgICAgIGlkOiBcImZvb2JhclwiXG4gICAgICAgICAgYXNzZXJ0ICFyZWNvcmQ/XG5cbiAgICAgICAgdGVzdCBcIm11bHRpcGxlIG5vdCBmb3VuZFwiLCAtPlxuICAgICAgICAgIHJlY29yZCA9IGF3YWl0IGJhc2UuZmluZEFsbFxuICAgICAgICAgICAgdGFibGU6IFwiUGFnaW5hdGlvbiBUZXN0XCJcbiAgICAgICAgICAgIGlkczogWyBcImZvb1wiLCBcImJhclwiIF1cbiAgICAgICAgICBhc3NlcnQuZXF1YWwgMCwgcmVjb3JkLmxlbmd0aFxuICAgICAgXG4gICAgICBdXG5cbiAgICAgIGF3YWl0IHRlc3QgXCJzZWxlY3RPbmVcIiwgLT5cbiAgICAgICAgcmVjb3JkID0gYXdhaXQgYmFzZS5zZWxlY3RPbmVcbiAgICAgICAgICB0YWJsZTogXCJUZXN0XCJcbiAgICAgICAgICBxdWVyeTogXCJ7TmFtZX0gPSAnVGVzdCdcIlxuICAgICAgICBhc3NlcnQuZXF1YWwgXCJUZXN0XCIsIHJlY29yZC5nZXQgXCJOYW1lXCJcblxuICAgICAgYXdhaXQgdGVzdCBcInNlbGVjdEFsbFwiLCAtPlxuICAgICAgICByZWNvcmRzID0gYXdhaXQgYmFzZS5zZWxlY3RBbGxcbiAgICAgICAgICB0YWJsZTogXCJQYWdpbmF0aW9uIFRlc3RcIlxuICAgICAgICBhc3NlcnQuZXF1YWwgMTEwLCByZWNvcmRzLmxlbmd0aFxuXG4gICAgICBhd2FpdCB0ZXN0IFwidXBkYXRlXCIsIC0+XG5cbiAgICAgICAgbm90ZXMgPSByZWNvcmQuZ2V0IFwiTm90ZXNcIlxuXG4gICAgICAgIGlmIG5vdGVzID09IFwiVGhpcyBpcyBhIHRlc3QuXCJcbiAgICAgICAgICBub3RlcyA9IFwiVGhpcyBpcyBub3QgYSB0ZXN0LlwiXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBub3RlcyA9IFwiVGhpcyBpcyBhIHRlc3QuXCJcblxuICAgICAgICByZWNvcmQgPSBhd2FpdCBiYXNlLnVwZGF0ZVxuICAgICAgICAgIHRhYmxlOiBcIlRlc3RcIlxuICAgICAgICAgIGlkOiByZWNvcmQuaWRcbiAgICAgICAgICBmaWVsZHM6XG4gICAgICAgICAgICBOb3Rlczogbm90ZXNcbiAgICAgICAgXG4gICAgICAgIGFzc2VydC5lcXVhbCBub3RlcywgcmVjb3JkLmdldCBcIk5vdGVzXCJcblxuICAgICAgYXdhaXQgdGVzdCBcInJlcGxhY2VcIiwgLT5cblxuICAgICAgICBub3RlcyA9IHJlY29yZC5nZXQgXCJOb3Rlc1wiXG5cbiAgICAgICAgaWYgbm90ZXMgPT0gXCJUaGlzIGlzIGEgdGVzdC5cIlxuICAgICAgICAgIG5vdGVzID0gXCJUaGlzIGlzIG5vdCBhIHRlc3QuXCJcbiAgICAgICAgZWxzZVxuICAgICAgICAgIG5vdGVzID0gXCJUaGlzIGlzIGEgdGVzdC5cIlxuXG4gICAgICAgIHJlY29yZCA9IGF3YWl0IGJhc2UucmVwbGFjZVxuICAgICAgICAgIHRhYmxlOiBcIlRlc3RcIlxuICAgICAgICAgIGlkOiByZWNvcmQuaWRcbiAgICAgICAgICBmaWVsZHM6XG4gICAgICAgICAgICBOb3Rlczogbm90ZXNcbiAgICAgICAgXG4gICAgICAgIGFzc2VydC5lcXVhbCBub3RlcywgcmVjb3JkLmdldCBcIk5vdGVzXCJcblxuICAgICAgYXdhaXQgdGVzdCBcImRlbGV0ZVwiLCAtPlxuICAgICAgICBhd2FpdCBiYXNlLmRlbGV0ZVxuICAgICAgICAgIHRhYmxlOiBcIlRlc3RcIlxuICAgICAgICAgIGlkOiByZWNvcmQuaWRcblxuICAgIF1cblxuXG4gIF1cblxuICBcbiAgcHJvY2Vzcy5leGl0IHN1Y2Nlc3NcblxuIl0sInNvdXJjZVJvb3QiOiIifQ==
//# sourceURL=test/index.coffee